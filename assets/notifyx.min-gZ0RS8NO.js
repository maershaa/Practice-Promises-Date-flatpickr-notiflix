const u=new Map,p=o=>{const e=document.createElement("div");return e.className="notifyx-container",e.setAttribute("data-position",o),e.setAttribute("aria-label",`Notifications ${o.replace("-"," ")}`),e},f=o=>{const e=u.get(o);if(e&&document.body.contains(e))return e;const t=document.querySelector(`.notifyx-container[data-position="${o}"]`);if(t)return u.set(o,t),t;const i=p(o);return document.body.appendChild(i),u.set(o,i),i},d={enter:"notifyx-spring-enter",exit:"notifyx-spring-exit"},T={TOP_RIGHT:"top-right"},h={type:"default",duration:3e3,showProgress:!0,showIcon:!0,pauseOnHover:!0,position:T.TOP_RIGHT,dismissible:!0,maxToasts:5},x={success:"✓",error:"✕",warning:"⚠",info:"ℹ",default:"●"};let a=null;class g{static createToastElement(e){const t=document.createElement("div");t.className=`notifyx notifyx-${e.type} ${d.enter}`,t.setAttribute("role","alert"),t.setAttribute("aria-live",e.type==="error"?"assertive":"polite"),t.setAttribute("aria-atomic","true");const i=document.createElement("div");i.className="notifyx-content";const n=document.createElement("div");if(n.className="notifyx-content-and-icon",e.showIcon){const r=document.createElement("div");r.className="notifyx-icon",r.textContent=e.icon||x[e.type],r.setAttribute("aria-hidden","true"),n.appendChild(r)}const s=document.createElement("span");if(s.className="notifyx-msg",s.textContent=e.message,n.appendChild(s),i.appendChild(n),e.dismissible&&i.appendChild(this.createCloseButton(t,e)),t.appendChild(i),e.showProgress&&e?.duration&&e?.duration>0){const r=document.createElement("div");r.className="notifyx-progress-bar",t.appendChild(r)}return t}static createLoaderElement(e){const t=document.createElement("div");t.className=`notifyx notifyx-${e.type} ${d.enter}`,t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-busy","true");const i=document.createElement("div");i.className="notifyx-loader";const n=document.createElement("div");if(n.className="notifyx-spinner",n.setAttribute("aria-label","Loading"),i.appendChild(n),e.message){const s=document.createElement("span");s.className="notifyx-msg",s.textContent=e.message,i.appendChild(s)}return t.appendChild(i),t}static createCloseButton(e,t){const i=document.createElement("button");return i.className="notifyx-close",i.setAttribute("aria-label","Close notification"),i.setAttribute("type","button"),i.onclick=()=>this.removeToast(e,t.onClose),i}static removeToast(e,t){if(e.hasAttribute("data-removing"))return;e.setAttribute("data-removing","true");const i=e?.__notifyxTimeout;console.log("toastElement:",e,"timeoutData:",i),i&&i.timeoutId!==null&&(clearTimeout(i.timeoutId),i.timeoutId=null);const n=e.__notifyxPauseTimer,s=e.__notifyxResumeTimer;n&&e.removeEventListener("mouseenter",n),s&&e.removeEventListener("mouseleave",s),delete e.__notifyxTimeout,delete e.__notifyxPauseTimer,delete e.__notifyxResumeTimer;const r=()=>{e.isConnected&&e.remove(),this.cleanupEmptyContainer(e.parentElement),t?.()};if(window.matchMedia("(prefers-reduced-motion: reduce)").matches){r();return}e.classList.remove(d.enter),e.classList.add(d.exit);const l=window.setTimeout(()=>{r()},400),c=y=>{y.target===e&&(clearTimeout(l),e.removeEventListener("animationend",c),r())};e.addEventListener("animationend",c)}static cleanupEmptyContainer(e){e&&e.childNodes.length===0&&e.remove()}static setupAutoDismiss(e,t){if(!t.duration||t.duration<=0)return;const i={timeoutId:null,startTime:Date.now(),remainingTime:t.duration,isPaused:!1},n=e.querySelector(".notifyx-progress-bar");n&&(n.style.width="100%",requestAnimationFrame(()=>{requestAnimationFrame(()=>{n.style.transition=`width ${t.duration}ms linear`,n.style.width="0%"})}));const s=()=>{if(!i.isPaused&&i.timeoutId!==null){i.isPaused=!0;const m=Date.now()-i.startTime;if(i.remainingTime=Math.max(0,i.remainingTime-m),n){const c=window.getComputedStyle(n).width;n.style.transition="none",n.style.width=c,n.offsetWidth}clearTimeout(i.timeoutId),i.timeoutId=null}},r=()=>{i.isPaused&&i.remainingTime>0&&(i.isPaused=!1,i.startTime=Date.now(),n&&requestAnimationFrame(()=>{n.style.transition=`width ${i.remainingTime}ms linear`,n.style.width="0%"}),i.timeoutId=window.setTimeout(()=>{this.removeToast(e,t.onClose)},i.remainingTime))};e.__notifyxPauseTimer=s,e.__notifyxResumeTimer=r,t.pauseOnHover&&(e.addEventListener("mouseenter",s),e.addEventListener("mouseleave",r)),i.timeoutId=window.setTimeout(()=>{this.removeToast(e,t.onClose)},t.duration),e.__notifyxTimeout=i}static enforceMaxToasts(e,t){const i=e.querySelectorAll(".notifyx");if(i.length>=t){const n=i[0];this.removeToast(n)}}static show(e){const t={...h,...e},i=f(t.position);this.enforceMaxToasts(i,t.maxToasts);const n=this.createToastElement(t);i.appendChild(n),this.setupAutoDismiss(n,t)}static success(e,t){this.show({...t,message:e,type:"success"})}static error(e,t){this.show({...t,message:e,type:"error"})}static warning(e,t){this.show({...t,message:e,type:"warning"})}static info(e,t){this.show({...t,message:e,type:"info"})}static loading(e,t){a&&(this.removeToast(a),a=null);const i={...h,...t,message:e,type:"info",duration:0,showProgress:!1,dismissible:!1,position:"center"},n=f("center"),s=this.createLoaderElement(i);n.appendChild(s),a=s}static dismissLoading(){a&&(this.removeToast(a),a=null)}static async promise(e,t,i){this.loading(t.loading,i);try{const n=await e;this.dismissLoading();const s=typeof t.success=="function"?t.success(n):t.success;return this.success(s,i),n}catch(n){this.dismissLoading();const s=typeof t.error=="function"?t.error(n):t.error;throw this.error(s,i),n}}static clear(){document.querySelectorAll(".notifyx-container").forEach(t=>{t.querySelectorAll(".notifyx").forEach(n=>{this.removeToast(n)})}),a=null}static dismiss(e){e&&e.classList.contains("notifyx")&&this.removeToast(e)}}typeof window<"u"&&(window.NotifyX=g);export{g as N};
